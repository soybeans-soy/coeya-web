<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>å£°å®¶ ãƒ‹ãƒ¥ãƒ¼ã‚¹ç®¡ç†ãƒ„ãƒ¼ãƒ« (ç·¨é›†æ©Ÿèƒ½ä»˜)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f7f6; padding: 40px; font-family: 'Noto Sans JP', sans-serif; }
        .container { max-width: 1000px; }
        .card { border-radius: 15px; border: none; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .news-item { background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; border-left: 5px solid #6c757d; transition: 0.2s; }
        .news-item:hover { box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .item-æ¡ç”¨ { border-left-color: #dc3545; }
        .item-é‡è¦ { border-left-color: #212529; }
        .edit-mode { background-color: #fff4e5; border-left-color: #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="mb-4 fw-bold text-center">å£°å®¶ News Data Manager</h2>
        
        <div class="card p-4 mb-4 text-center">
            <h5 class="fw-bold mb-3">1. news.json ã‚’èª­ã¿è¾¼ã‚€</h5>
            <input type="file" id="fileInput" class="form-control w-50 mx-auto" accept=".json">
        </div>

        <div class="card p-4 mb-4">
            <h5 class="fw-bold mb-3" id="formTitle">2. æ–°ã—ã„ãŠçŸ¥ã‚‰ã›ã‚’è¿½åŠ </h5>
            <input type="hidden" id="editIndex" value="-1">
            <div class="row g-3">
                <div class="col-md-3">
                    <label class="small fw-bold">æ—¥ä»˜</label>
                    <input type="text" id="date" class="form-control" placeholder="2025.12.25">
                </div>
                <div class="col-md-3">
                    <label class="small fw-bold">ã‚«ãƒ†ã‚´ãƒª</label>
                    <select id="category" class="form-select">
                        <option value="ãŠçŸ¥ã‚‰ã›">ãŠçŸ¥ã‚‰ã›</option>
                        <option value="æ¡ç”¨">æ¡ç”¨</option>
                        <option value="é‡è¦">é‡è¦</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <label class="small fw-bold">ã‚¿ã‚¤ãƒˆãƒ«</label>
                    <input type="text" id="title" class="form-control" placeholder="ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›">
                </div>
                <div class="col-12">
                    <label class="small fw-bold">å†…å®¹ï¼ˆçŸ­ã„èª¬æ˜ï¼‰</label>
                    <textarea id="content" class="form-control" rows="2" placeholder="å†…å®¹ã‚’å…¥åŠ›"></textarea>
                </div>
                <div class="col-md-8">
                    <label class="small fw-bold">ãƒªãƒ³ã‚¯å…ˆURL (ä»»æ„)</label>
                    <input type="text" id="link" class="form-control" placeholder="news/recruit.html ãªã©">
                </div>
                <div class="col-md-4 d-flex align-items-end">
                    <button onclick="saveItem()" id="saveBtn" class="btn btn-primary w-100 fw-bold">ãƒªã‚¹ãƒˆã«è¿½åŠ ã™ã‚‹</button>
                    <button onclick="resetForm()" id="cancelBtn" class="btn btn-outline-secondary ms-2 d-none">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                </div>
            </div>
        </div>

        <div id="newsList">
            <p class="text-center text-muted mt-5">ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ã‹ã€æ–°ã—ã„é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <div class="text-center mt-5 mb-5">
            <button onclick="downloadJSON()" class="btn btn-success btn-lg px-5 shadow fw-bold">
                <i class="fas fa-download me-2"></i> ç·¨é›†æ¸ˆã¿JSONã‚’ä¿å­˜ã™ã‚‹
            </button>
        </div>
    </div>

    <script>
        let newsData = [];

        // ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿å‡¦ç†
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    newsData = JSON.parse(event.target.result);
                    renderList();
                } catch (err) {
                    alert('JSONã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚');
                }
            };
            reader.readAsText(file);
        });

        // ãƒ‡ãƒ¼ã‚¿ã®æç”»
        function renderList() {
            const listDiv = document.getElementById('newsList');
            if (newsData.length === 0) {
                listDiv.innerHTML = '<p class="text-center text-muted mt-5">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
                return;
            }
            listDiv.innerHTML = '<h5 class="fw-bold mb-3">ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆæœ€æ–°é †ï¼‰</h5>';
            newsData.forEach((item, index) => {
                const isEditing = document.getElementById('editIndex').value == index;
                listDiv.innerHTML += `
                    <div class="news-item item-${item.category} ${isEditing ? 'edit-mode' : ''} shadow-sm d-flex justify-content-between align-items-center">
                        <div style="flex: 1;">
                            <div class="mb-1">
                                <span class="badge ${item.badgeClass || 'bg-secondary'} me-2">${item.category}</span>
                                <small class="text-muted">${item.date}</small>
                            </div>
                            <div class="fw-bold text-dark">${item.title}</div>
                            <div class="small text-muted text-truncate" style="max-width: 500px;">${item.content}</div>
                        </div>
                        <div class="ms-3 d-flex gap-2">
                            <button onclick="editItem(${index})" class="btn btn-sm btn-outline-primary">ç·¨é›†</button>
                            <button onclick="deleteItem(${index})" class="btn btn-sm btn-outline-danger">å‰Šé™¤</button>
                        </div>
                    </div>`;
            });
        }

        // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚‹
        function editItem(index) {
            const item = newsData[index];
            document.getElementById('editIndex').value = index;
            document.getElementById('date').value = item.date;
            document.getElementById('category').value = item.category;
            document.getElementById('title').value = item.title;
            document.getElementById('content').value = item.content;
            document.getElementById('link').value = item.link || '';
            
            document.getElementById('formTitle').innerText = "ğŸ“ é …ç›®ã‚’ç·¨é›†ã—ã¦ä¿å­˜";
            document.getElementById('saveBtn').innerText = "å¤‰æ›´ã‚’ç¢ºå®šã™ã‚‹";
            document.getElementById('saveBtn').className = "btn btn-warning w-100 fw-bold";
            document.getElementById('cancelBtn').classList.remove('d-none');
            
            renderList();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ä¿å­˜ï¼ˆæ–°è¦è¿½åŠ  ã¾ãŸã¯ æ›´æ–°ï¼‰
        function saveItem() {
            const index = parseInt(document.getElementById('editIndex').value);
            const category = document.getElementById('category').value;
            const badgeMap = { "ãŠçŸ¥ã‚‰ã›": "bg-secondary", "æ¡ç”¨": "bg-danger", "é‡è¦": "bg-dark" };
            
            const item = {
                date: document.getElementById('date').value,
                category: category,
                badgeClass: badgeMap[category],
                title: document.getElementById('title').value,
                content: document.getElementById('content').value,
                link: document.getElementById('link').value
            };

            if (index === -1) {
                // æ–°è¦è¿½åŠ 
                newsData.unshift(item);
            } else {
                // æ›´æ–°
                newsData[index] = item;
            }

            resetForm();
            renderList();
        }

        // ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒªã‚»ãƒƒãƒˆ
        function resetForm() {
            document.getElementById('editIndex').value = "-1";
            document.getElementById('date').value = "";
            document.getElementById('title').value = "";
            document.getElementById('content').value = "";
            document.getElementById('link').value = "";
            document.getElementById('formTitle').innerText = "2. æ–°ã—ã„ãŠçŸ¥ã‚‰ã›ã‚’è¿½åŠ ";
            document.getElementById('saveBtn').innerText = "ãƒªã‚¹ãƒˆã«è¿½åŠ ã™ã‚‹";
            document.getElementById('saveBtn').className = "btn btn-primary w-100 fw-bold";
            document.getElementById('cancelBtn').classList.add('d-none');
            renderList();
        }

        // å‰Šé™¤
        function deleteItem(index) {
            if(confirm('ã“ã®é …ç›®ã‚’å®Œå…¨ã«å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                newsData.splice(index, 1);
                renderList();
            }
        }

        // JSONãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        function downloadJSON() {
            const jsonString = JSON.stringify(newsData, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'news.json';
            a.click();
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>
</body>
</html>